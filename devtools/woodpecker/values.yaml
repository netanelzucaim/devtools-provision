# Custom values for Woodpecker CI Helm chart - Portable Configuration
# Works on localhost with Gitea as the forge

# SECURITY WARNING: The WOODPECKER_AGENT_SECRET below is set to a default value
# for demonstration purposes. For production use, you MUST change this to a secure,
# randomly generated secret. Generate one with: openssl rand -hex 32

woodpecker:
  server:
    image:
      repository: woodpeckerci/woodpecker-server
      tag: v2.7.0
      pullPolicy: IfNotPresent
    
    replicas: 1
    
    env:
      WOODPECKER_HOST: http://localhost:8000
      WOODPECKER_ADMIN: netanelzucaim
      WOODPECKER_OPEN: "false"
      WOODPECKER_AGENT_SECRET: changeme  # CHANGE THIS! Generate with: openssl rand -hex 32
      # Gitea OAuth2 Configuration
      WOODPECKER_GITEA: "true"
      WOODPECKER_GITEA_URL: http://gitea-http.gitea.svc.cluster.local:3000
      WOODPECKER_GITEA_CLIENT: "62a5a32e-271b-4fab-80f4-1c0367017530"
      WOODPECKER_GITEA_SECRET: "gto_y6ewbigjmregtltheedvka4ou2hovwbdxxuqdm5uhlfmpswu4sya"
      WOODPECKER_GITEA_SKIP_VERIFY: "true"
      # Disable GitHub
      WOODPECKER_GITHUB: "false"
    
    service:
      type: ClusterIP
      port: 8000
      httpPort: 8000
      grpcPort: 9000
    
    resources:
      limits:
        cpu: 500m
        memory: 512Mi
      requests:
        cpu: 100m
        memory: 128Mi
    
    persistence:
      enabled: true
      size: 10Gi
      storageClass: standard
      accessMode: ReadWriteOnce

  agent:
    enabled: true
    replicaCount: 1
    
    image:
      repository: woodpeckerci/woodpecker-agent
      tag: v2.7.0
      pullPolicy: IfNotPresent
    
    env:
      WOODPECKER_SERVER: woodpecker-server:9000
      WOODPECKER_AGENT_SECRET: changeme  # MUST match server secret! Change both!
    
    resources:
      limits:
        cpu: 1000m
        memory: 1Gi
      requests:
        cpu: 100m
        memory: 128Mi
